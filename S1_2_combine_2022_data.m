fmet=['CA-Ca3_HH_202201010000_202301010000.csv'];
fnamemet=['E:\Paper\HDF88\data\AMF_CA-Ca3_BASE-BADM_5-5\',fmet];
[~,~,rawmet]=xlsread(fnamemet);
xmet=cell2mat(rawmet(2:end,3:end));
xmet(17520,:)=nan;
xmet(xmet<-9997)=nan;

co2=[co2;xmet(:,1)];
h2o=[h2o;xmet(:,2)];
fc=[fc;xmet(:,3)];
sc=[sc;xmet(:,4)];
g=[g;xmet(:,5:9)];
h=[h;xmet(:,10)];
le=[le;xmet(:,11)];
sg=[sg;xmet(:,12)];
sh=[sh;xmet(:,13)];
sle=[sle;xmet(:,14)];
sb=[sb;xmet(:,15)];
wd=[wd;xmet(:,16)];
ws=[ws;xmet(:,17)];
ustar=[ustar;xmet(:,18)];
ta=[ta;xmet(:,22)];
pa=[pa;xmet(:,23)];
rh=[rh;xmet(:,24)];
vpd=[vpd;xmet(:,25)];
ts=[ts;xmet(:,28:35)];
swc=[swc;xmet(:,36:41)];
ppt=[ppt;xmet(:,42)];
rn=[rn;xmet(:,43)];
parin=[parin;xmet(:,44)];
parout=[parout;xmet(:,45)];
swin=[swin;xmet(:,46)];
swout=[swout;xmet(:,47)];
lwin=[lwin;xmet(:,48)];
lwout=[lwout;xmet(:,49)];
nee=[nee;xmet(:,50)];
re=[re;xmet(:,51)];
gpp=[gpp;xmet(:,52)];
%%
nee(nee>50|nee<-50)=nan;
gpp(gpp<-20|gpp>50)=nan;
re(re<-20|re>50)=nan;
sb(sb>50)=nan;
ti=(datenum(2001,1,1,0,30,0):datenum(0,0,0,0,30,0):datenum(2022,12,31,24,0,0))';
%%
ti(1:17520,:)=[];
co2(1:17520,:)=[];
fc(1:17520,:)=[];
g(1:17520,:)=[];
gpp(1:17520,:)=[];
h(1:17520,:)=[];
h2o(1:17520,:)=[];
le(1:17520,:)=[];
lwin(1:17520,:)=[];
lwout(1:17520,:)=[];
nee(1:17520,:)=[];
pa(1:17520,:)=[];
parin(1:17520,:)=[];
parout(1:17520,:)=[];
ppt(1:17520,:)=[];
re(1:17520,:)=[];
rh(1:17520,:)=[];
rn(1:17520,:)=[];
sb(1:17520,:)=[];
sc(1:17520,:)=[];
sg(1:17520,:)=[];
sh(1:17520,:)=[];
sle(1:17520,:)=[];
swc(1:17520,:)=[];
swin(1:17520,:)=[];
swout(1:17520,:)=[];
ta(1:17520,:)=[];
ts(1:17520,:)=[];
ustar(1:17520,:)=[];
vpd(1:17520,:)=[];
wd(1:17520,:)=[];
ws(1:17520,:)=[];
